summary(ace_uni_c_umx)
# results
summary(ace_uni_c_twinflex)
summary(ace_uni_c_umx)
# bivariate (Cholesky) continous (Weight - wt - and Height - ht)
# twinflex
ace_biv_c_twinflex <- twinflex(acevars = c("wt","ht"),data = twinData,sep = "",zyg = "zyg_r", type = "chol")
ace_uni_c_twinflex <- twinflex(acevars = "wt",covvar = "ht",data = twinData,sep = "",zyg = "zyg_r")
ace_uni_c_twinflex <- twinflex(acevars = "wt",covvar = "ht",data = twinData,sep = "",zyg = "zyg_r")
ace_uni_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",data = twinData,sep = "",zyg = "zyg_r")
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
# univariate continuous (Weight)
# twinflex
ace_uni_c_twinflex <- twinflex(acevars = "wt",data = twinData,sep = "",zyg = "zyg_r")
ace_uni_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",data = twinData,sep = "",zyg = "zyg_r")
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",data = twinData,sep = "",zyg = "zyg_r")
ace_unicov_c_twinflex
summary(ace_unicov_c_twinflex)
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
# univariate continuous (Weight)
# twinflex
ace_uni_c_twinflex <- twinflex(acevars = "wt",data = twinData,sep = "",zyg = "zyg_r")
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
##############################
# Comparison of model results
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
View(twinData)
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData,sep = "",zyg = "zyg_r")
twinData123 <- !is.na(twinData[,covvarsall])
twinData123 <- !is.na(twinData[,c("ht1","ht2")])
View(twinData123)
# example script using twinflex
# clear workspace
rm(list = ls())
# load packages for twinflex
library(OpenMx)
library(umx)
library(dplyr)
# load example twin data "Australian twin sample biometric data"
data("twinData")
# summary of example twin data
summary(twinData)
# load twinflex
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# data preparation
twinData <- twinData %>% mutate(zyg_r = ifelse(zygosity %in% c("MZFF","MZMM"), 1, # 1 = MZ!
ifelse(zygosity %in% c("DZFF","DZMM","DZOS"), 2, NA))) # 2 = DZ!
# prepare data frames for umx
mz    <- subset(twinData, zyg_r==1,c("ht1","ht2","wt1","wt2"))
dz    <- subset(twinData, zyg_r==2,c("ht1","ht2","wt1","wt2"))
twinData1 <- twinData %>% filter(!is.na(ht1) & !is.na(ht2))
ace_unicov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData1,sep = "",zyg = "zyg_r")
summary(ace_unicov_c_twinflex)
mxCheckIdentification(ace_unicov_c_twinflex)
ace_unicov_def_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = FALSE, data = twinData1,sep = "",zyg = "zyg_r")
# model with covariate in covariance matrix
ace_unicov_cov_c_twinflex <- twinflex(acevars = "wt",covvars = "ht",covariance = TRUE, data = twinData,sep = "",zyg = "zyg_r")
summary(ace_unicov_def_c_twinflex)
summary(ace_unicov_cov_c_twinflex)
