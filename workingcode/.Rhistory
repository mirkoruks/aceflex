rm(list = ls())
library(dplyr)
library(OpenMx)
library(xtable)
library(umx)
data_orig <- read.csv(file = "C:/Users/Besitzer/Documents/Arbeit/Twinlife/Artikel/Netzwerke/Git/netzwerke/Update/data_wide.csv",
header = TRUE)
summary(data_orig)
# create binary variable
data_orig <- data_orig %>% mutate(schoolb_1 = ifelse(schoolhigh_1 <= 2, 1,
ifelse(schoolhigh_1 >= 3, 2, NA))) %>%
mutate(schoolb_2 = ifelse(schoolhigh_2 <= 2, 1,
ifelse(schoolhigh_2 >= 3, 2, NA))) %>%
mutate(kukabin_1 = ifelse(kultkapjahre_1 >= median(kultkapjahre_1, na.rm = TRUE),1,
ifelse(kultkapjahre_1 < median(kultkapjahre_1, na.rm = TRUE),2,NA))) %>%
mutate(kukabin_2 = ifelse(kultkapjahre_2 >= median(kultkapjahre_1, na.rm = TRUE),1,
ifelse(kultkapjahre_2 < median(kultkapjahre_1, na.rm = TRUE),2,NA)))
mz_data <- data_orig %>% filter(zyg ==1)
dz_data <- data_orig %>% filter(zyg ==2)
ovars <- c("schoolhigh_1","schoolhigh_2","schoolb_1","schoolb_2","kukabin_1","kukabin_2")
mz_data[,ovars] <- umxFactor(mz_data[,ovars])
dz_data[,ovars] <- umxFactor(dz_data[,ovars])
# load twinflex function
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
selfmod <- twinflex(acevars = c("posbez"),data = gxe1,sep = "_",zyg = "zyg", modACEuniv = "posbez BY posbez", tryHard = TRUE) ## works fine
gxe11 <- data_orig %>% filter(!is.na(posbez_1) & !is.na(posbez_2))
selfmod <- twinflex(acevars = c("posbez"),data = gxe11,sep = "_",zyg = "zyg", modACEuniv = "posbez BY posbez", tryHard = TRUE) ## works fine
selfmod[["ModelSummary"]]
gxe11 <- data_orig %>% filter(!is.na(posbez_1) & !is.na(posbez_2))
gxe11$posbez_1 <- scale(gxe11$posbez_1)
gxe11$posbez_2 <- scale(gxe11$posbez_2)
gxe11 <- data_orig %>% filter(!is.na(posbez_1) & !is.na(posbez_2))
gxe11$posbez_1 <- scale(gxe11$posbez_1)
gxe11$posbez_2 <- scale(gxe11$posbez_2)
selfmod <- twinflex(acevars = c("posbez"),data = gxe11,sep = "_",zyg = "zyg", modACEuniv = "posbez BY posbez", tryHard = TRUE, exh = FALSE) ## works fine
selfmod[["ModelSummary"]]
# univariate GxE with constant moderator and continuous DV
# twinflex
gxe1 <- data_orig %>% filter(!is.na(age))
tf_modu_c <- twinflex(acevars = c("posbez"),data = gxe1,sep = "_",zyg = "zyg", modACEuniv = "posbez BY age", tryHard = TRUE) ## works fine
# bivariate GxE
# twinflex
gxe2 <- data_orig %>% filter(!is.na(posbez_1) & !is.na(posbez_2))
tf_modb_c <- twinflex(acevars = c("posbez","negbez"),data = gxe2,sep = "_",zyg = "zyg", modACEuniv = "negbez BY posbez",modACEbiv = "posbez -> negbez BY posbez") ## works fine
# comparison
tf_modu_c[["ModelSummary"]] # -2LL = 16922.94
rm(list = ls())
library(dplyr)
library(OpenMx)
library(xtable)
library(umx)
data_orig <- read.csv(file = "C:/Users/Besitzer/Documents/Arbeit/Twinlife/Artikel/Netzwerke/Git/netzwerke/Update/data_wide.csv",
header = TRUE)
summary(data_orig)
# create binary variable
data_orig <- data_orig %>% mutate(schoolb_1 = ifelse(schoolhigh_1 <= 2, 1,
ifelse(schoolhigh_1 >= 3, 2, NA))) %>%
mutate(schoolb_2 = ifelse(schoolhigh_2 <= 2, 1,
ifelse(schoolhigh_2 >= 3, 2, NA))) %>%
mutate(kukabin_1 = ifelse(kultkapjahre_1 >= median(kultkapjahre_1, na.rm = TRUE),1,
ifelse(kultkapjahre_1 < median(kultkapjahre_1, na.rm = TRUE),2,NA))) %>%
mutate(kukabin_2 = ifelse(kultkapjahre_2 >= median(kultkapjahre_1, na.rm = TRUE),1,
ifelse(kultkapjahre_2 < median(kultkapjahre_1, na.rm = TRUE),2,NA)))
mz_data <- data_orig %>% filter(zyg ==1)
dz_data <- data_orig %>% filter(zyg ==2)
ovars <- c("schoolhigh_1","schoolhigh_2","schoolb_1","schoolb_2","kukabin_1","kukabin_2")
mz_data[,ovars] <- umxFactor(mz_data[,ovars])
dz_data[,ovars] <- umxFactor(dz_data[,ovars])
# load twinflex function
source("C:/Users/Besitzer/Documents/Arbeit/Twinlife/twinflex/Git/twinflex.R")
# univariate GxE with constant moderator and continuous DV
# twinflex
gxe1 <- data_orig %>% filter(!is.na(age))
tf_modu_c <- twinflex(acevars = c("posbez"),data = gxe1,sep = "_",zyg = "zyg", modACEuniv = "posbez BY age", type = "aceb") ## works fine
tf_modu_c <- twinflex(acevars = c("posbez"),data = gxe1,sep = "_",zyg = "zyg", modACEuniv = "posbez BY age", type = "aceb", tryHard = TRUE) ## works fine
tf_modu_c[["ModelSummary"]]
tf_modu_c <- twinflex(acevars = c("posbez"),data = data_orig,sep = "_",zyg = "zyg", modACEuniv = "posbez BY age", type = "aceb", tryHard = TRUE) ## works fine
